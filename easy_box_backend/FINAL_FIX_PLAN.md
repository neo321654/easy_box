# План финальных исправлений и тестирования

Этот документ отслеживает задачи для исправления загрузки изображений и полного тестирования функциональности.

## Фаза 1: Исправление ошибок

- [ ] **Проблема:** Ошибка 404 при загрузке изображения для продукта (`/api/products/{id}/upload-image`).
  - **Решение:** Создать кастомный `upload_image` экшен в `ProductViewSet`.
  - [ ] *Шаг 1: Добавить метод `upload_image` в `api/views.py`.*
  - [ ] *Шаг 2: Обновить `api/urls.py`, если потребуется (хотя `DefaultRouter` должен справиться).*

- [ ] **Проблема:** В админ-панели для изображения продукта отображается текстовое поле URL вместо поля для загрузки файла.
  - **Решение:** Настроить `ProductAdmin` для обработки загрузки изображений.
  - [ ] *Шаг 1: Создать кастомную форму `ProductAdminForm` с полем `ImageField`.*
  - [ ] *Шаг 2: Создать класс `ProductAdmin` в `api/admin.py`.*
  - [ ] *Шаг 3: Переопределить метод `save_model` в `ProductAdmin` для сохранения изображения в Cloudinary.*

## Фаза 2: Полное тестирование функциональности

- [ ] **Подготовка:**
  - [ ] Получить токен аутентификации.
  - [ ] Добавить задержку в 3 минуты после деплоя для обновления сервера.

- [ ] **Продукты (Products):**
  - [ ] Создать продукт без изображения.
  - [ ] Загрузить изображение для созданного продукта (`POST /api/products/{id}/upload_image/`).
  - [ ] Обновить информацию о продукте.
  - [ ] Удалить продукт.

- [ ] **Заказы (Orders):**
  - [ ] Создать продукт для заказа.
  - [ ] Создать заказ с этим продуктом.
  - [ ] Обновить статус заказа.
  - [ ] Удалить заказ.

- [ ] **Админ-панель:**
  - [ ] Проверить, что в админ-панели продукта появилось поле для загрузки файла.
  - [ ] (Мануально) Проверить загрузку изображения через админ-панель.

## Фаза 3: Завершение

- [ ] Удалить файл `FINAL_FIX_PLAN.md`.
- [ ] Закоммитить и запушить все исправления.
