# План отладки бэкенда

Этот документ отслеживает шаги по диагностике и исправлению проблем с бэкендом Django.

## Фаза 1: Диагностика

- [x] Проверить, отвечает ли сервер на базовые запросы (`curl -I http://38.244.208.106:8000`).
- [ ] Проверить эндпоинт админ-панели (`curl http://3.244.208.106:8000/admin/`).
- [x] Проверить эндпоинты API на доступность (например, `curl http://38.244.208.106:8000/api/products/`).
- [ ] Проанализировать `settings.py` на предмет потенциальных проблем с конфигурацией (база данных, `SECRET_KEY`, `DEBUG` флаг).
- [ ] Проанализировать `Dockerfile` и `docker-compose.yml` на предмет проблем с запуском сервера.

## Фаза 2: Исправление

- [x] **Проблема:** Неправильная конфигурация URL-адресов API.
  - [x] **Решение:** Изменить `backend/urls.py` и `api/urls.py`, чтобы все эндпоинты API находились по префиксу `/api/`.
  - [x] *Шаг 1: Добавить префикс `/api/` в `backend/urls.py`.*
  - [x] *Шаг 2: Убрать лишние префиксы из `api/urls.py` и добавить слэш к `auth/token/`.*
- [x] **Проблема:** `DEBUG = True` в продакшене.
  - [x] **Решение:** Установить `DEBUG = False` в `settings.py`.
- [x] **Проблема:** Отсутствует таблица `authtoken_token` в базе данных.
  - [x] **Решение:** Добавить команду `migrate` в `Dockerfile`.

## Фаза 3: Тестирование функциональности

- [ ] **Аутентификация:**
  - [ ] Получить токен (`/auth/token`).
  - [ ] Получить доступ к защищенному эндпоинту с токеном.
- [ ] **Продукты (Products):**
  - [ ] Получить список продуктов (`GET /api/products/`).
  - [ ] Создать новый продукт (`POST /api/products/`).
  - [ ] Получить, обновить, удалить продукт (`GET`, `PUT`, `DELETE /api/products/{id}/`).
- [ ] **Заказы (Orders):**
  - [ ] Получить список заказов (`GET /api/orders/`).
  - [ ] Создать новый заказ (`POST /api/orders/`).
  - [ ] Получить, обновить, удалить заказ (`GET`, `PUT`, `DELETE /api/orders/{id}/`).
- [ ] **Загрузка изображений:**
  - [ ] Проверить загрузку изображения при создании/обновлении продукта.

## Фаза 4: Завершение

- [ ] Удалить файл `DEBUG_PLAN.md`.
- [ ] Закоммитить и запушить исправления.
