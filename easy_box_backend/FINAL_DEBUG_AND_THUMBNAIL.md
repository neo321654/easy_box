# План отладки сети и добавления миниатюр

Этот документ отслеживает шаги по диагностике сетевой проблемы на стороне клиента и реализации создания миниатюр на бэкенде.

## Фаза 1: Бэкенд - Создание миниатюр

- [ ] **Задача:** Добавить автоматическое создание URL миниатюры при загрузке изображения.
  - [ ] *Шаг 1: Добавить поле `thumbnail_url` в модель `Product` в `api/models.py`.*
  - [ ] *Шаг 2: Создать и применить миграции базы данных (`makemigrations`, `migrate`).*
  - [ ] *Шаг 3: Обновить `ProductSerializer`, добавив в него поле `thumbnail_url`.*
  - [ ] *Шаг 4: Модифицировать логику загрузки изображений в `api/views.py` (`upload_image`) и `api/admin.py` (`save_model`) для генерации и сохранения URL миниатюры. Cloudinary позволяет это сделать, добавив параметры трансформации в URL.*

## Фаза 2: Flutter-приложение - Интеграция миниатюр и диагностика сети

- [ ] **Задача:** Использовать миниатюры в приложении и добавить диагностику.
  - [ ] *Шаг 1: Обновить модель `Product` и сущность `Product` в Flutter, добавив поле `thumbnailUrl`.*
  - [ ] *Шаг 2: Обновить `ProductListItem` виджет для использования `thumbnailUrl` вместо `imageUrl` для повышения производительности.*
  - [ ] *Шаг 3: (Диагностика) Добавить в `ProductImage` виджет более подробный вывод ошибок, чтобы лучше понимать причину сбоя загрузки.*

## Фаза 3: Развертывание и Тестирование

- [ ] **Задача:** Развернуть изменения и провести полное тестирование.
  - [ ] *Шаг 1: Закоммитить и отправить все изменения (бэкенд и фронтенд).*
  - [ ] *Шаг 2: Подождать 3 минуты для завершения деплоя.*
  - [ ] *Шаг 3: Провести полное тестирование функциональности, включая:*
    - [ ] Создание продукта с изображением.
    - [ ] Проверка, что и `image_url`, и `thumbnail_url` были созданы.
    - [ ] Проверка, что список продуктов в приложении использует миниатюры.
    - [ ] Проверка, что детальный вид продукта использует полное изображение.

## Фаза 4: Завершение

- [ ] Удалить файл `FINAL_DEBUG_AND_THUMBNAIL.md`.
- [ ] Закоммитить финальные изменения.
